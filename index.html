<!DOCTYPE html><html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>IEA | Registration Community</title>  <!-- Fonts (TIDAK DIUBAH) -->  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">  <!-- ================= THEME & UI (UTUH, TIDAK DIUBAH) ================= -->  <style>
    :root{
      --neon:#00f2ff;--bg:#00020a;--card-bg:rgba(0,8,20,.85);
      --border:rgba(0,242,255,.3);--danger:#ff3e3e;--success:#00ff88;
    }
    *{box-sizing:border-box;cursor:crosshair;-webkit-tap-highlight-color:transparent}
    html,body{margin:0;background:var(--bg);color:#fff;font-family:'Rajdhani',sans-serif;min-height:100vh}
    #canvas{position:fixed;top:0;left:0;z-index:-1}

    .system-bar{
      position:fixed;top:0;width:100%;padding:12px 20px;
      background:rgba(0,2,10,.8);backdrop-filter:blur(10px);
      display:flex;justify-content:space-between;align-items:center;
      font-family:'Orbitron';font-size:10px;color:var(--neon);
      border-bottom:1px solid var(--border);z-index:1000;
    }

    header{text-align:center;padding:100px 20px 40px}
    header h1{
      font-family:'Orbitron';font-size:clamp(2rem,7vw,3.5rem);
      background:linear-gradient(#fff,var(--neon));
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;
    }

    .main-wrapper{
      max-width:1100px;margin:auto;padding:0 20px 80px;
      display:grid;grid-template-columns:1fr 1fr;gap:30px;
    }
    @media(max-width:850px){.main-wrapper{grid-template-columns:1fr}}

    .card{
      background:var(--card-bg);border:1px solid var(--border);
      border-radius:8px;padding:25px;backdrop-filter:blur(15px);
    }
    .card::before{
      content:"SECURE_CONNECTION";position:absolute;top:-10px;right:20px;
      font-size:9px;font-family:'Orbitron';color:var(--neon);
    }

    h2{font-family:'Orbitron';font-size:16px;color:var(--neon);letter-spacing:2px}
    .input-box{margin-bottom:18px}
    label{font-size:11px;color:var(--neon);font-weight:700}
    input,textarea{
      width:100%;background:rgba(0,242,255,.05);
      border:1px solid var(--border);padding:14px;color:#fff;
      border-radius:4px;font-family:'Rajdhani'
    }
    input:focus,textarea:focus{border-color:var(--neon);outline:none}

    .btn-send{
      width:100%;padding:18px;border:1px solid var(--neon);
      background:transparent;color:var(--neon);
      font-family:'Orbitron';letter-spacing:3px;font-weight:bold;
    }
    .btn-send:hover{background:var(--neon);color:#000}

    #status-box{margin-top:20px;padding:15px;border-radius:4px;display:none}
    .success-mode{border:1px solid var(--success);color:var(--success)}
    .error-mode{border:1px solid var(--danger);color:var(--danger)}

    table{width:100%;border-collapse:collapse}
    th,td{padding:10px;border-bottom:1px solid rgba(255,255,255,.05)}
    th{color:var(--neon);font-size:11px}
    .status-on{width:7px;height:7px;background:var(--neon);border-radius:50%;display:inline-block}
    .wa-btn{display:inline-block;margin-top:12px;padding:10px 20px;
      background:var(--success);color:#000;text-decoration:none;font-weight:bold}
  </style></head><body>
<canvas id="canvas"></canvas><div class="system-bar">
  <div>IEA/div>
  <div id="clock">00:00:00 UTC</div>
  <div>SIGNAL: STABLE</div>
</div><header>
  <h1>REGISTRATION COMMUNITY</h1>
  <p style="color:var(--neon);letter-spacing:4px;font-size:12px">
    INTERNATIONAL EDUCATION ASTRONOMY
  </p>
</header><div class="main-wrapper"><!-- ================= FORM ================= --><div class="card">
  <h2>REGISTRASI</h2>  <div class="input-box">
    <label>NAMA LENGKAP</label>
    <input id="name" autocomplete="off">
  </div>  <div class="input-box">
    <label>UMUR</label>
    <input id="age" type="number" min="15" max="40">
  </div>  <div class="input-box">
    <label>TIKTOK URL</label>
    <input id="tiktok" placeholder="https://tiktok.com/@username">
  </div>  <div class="input-box">
    <label>TUJUAN</label>
    <textarea id="reason" rows="2"></textarea>
  </div><button class="btn-send" id="submitBtn" onclick="sendData()">KIRIM TRANSMISI</button>

  <div id="status-box"></div>
</div><!-- ================= LOG ================= --><div class="card">
  <h2>PERSONNEL LOG</h2>
  <table>
    <thead>
      <tr><th>OPERATOR</th><th>AGE</th><th>STATUS</th></tr>
    </thead>
    <tbody id="dataTable"></tbody>
  </table>
</div></div><!-- ================= SCRIPT (FINAL, RAPI, AMAN) ================= --><script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getDatabase, ref, push, set, onValue, query, limitToLast } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-database.js";

const CONFIG = {
  apiKey: "AIzaSyA4lpo6PyADXVVki-bBfcEFf0kxbQuunN8",
  databaseURL: "https://iea-pendaftaran-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "iea-pendaftaran"
};

const WA_LINK = "https://chat.whatsapp.com/DUOPhz2B44v7PPnBMqxScX";
const STORAGE_KEY = "iea_registered";

const app = initializeApp(CONFIG);
const db = getDatabase(app);

setInterval(() => {
  clock.innerText = new Date().toUTCString().split(" ")[4] + " UTC";
}, 1000);

function showStatus(msg, ok=false){
  const box = document.getElementById('status-box');
  box.style.display = 'block';
  box.className = ok ? 'success-mode' : 'error-mode';
  box.innerHTML = msg;
}

function validName(n){return /^[A-Za-z\s]{3,50}$/.test(n)}
function validTikTok(u){return /^https:\/\/(www\.)?tiktok\.com\/@[\w.]+$/.test(u)}

window.sendData = async () => {
  const name = document.getElementById('name').value.trim();
  const age  = Number(document.getElementById('age').value);
  const tiktok = document.getElementById('tiktok').value.trim();
  const reason = document.getElementById('reason').value.trim();
  const btn = document.getElementById('submitBtn');

  if(localStorage.getItem(STORAGE_KEY)) return showStatus('ANDA SUDAH TERDAFTAR');
  if(!validName(name)) return showStatus('NAMA TIDAK VALID');
  if(!Number.isInteger(age) || age < 15 || age > 40) return showStatus('UMUR 15â€“40');
  if(!validTikTok(tiktok)) return showStatus('LINK TIKTOK TIDAK VALID');
  if(reason.length < 10) return showStatus('MOTIVASI MINIMAL 10 KARAKTER');

  btn.disabled = true;
  btn.innerText = 'UPLOADING...';

  await set(push(ref(db,'registrations')), {
    name, age, tiktok, reason, timestamp: Date.now()
  });

  localStorage.setItem(STORAGE_KEY,'1');
  showStatus(`LULUS VERIFIKASI<br><a href="${WA_LINK}" class="wa-btn">GABUNG WHATSAPP</a>`, true);
  setTimeout(()=>location.href=WA_LINK,3000);
};

onValue(query(ref(db,'registrations'), limitToLast(8)), snap => {
  const tb = document.getElementById('dataTable');
  tb.innerHTML = '';
  snap.forEach(c => {
    const d = c.val();
    tb.innerHTML += `<tr><td><span class='status-on'></span> ${d.name.slice(0,12)}</td><td>${d.age}</td><td style='color:var(--neon)'>ONLINE</td></tr>`;
  });
});
</script></body>
</html>
